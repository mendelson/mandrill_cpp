HEADER_PATH = ../source/header/
SRC_PATH = ../source/src/
BIN_DIR = ../bin/

CORE_HPP = $(HEADER_PATH)Core.hpp
FRAMESMANAGER_HPP = $(HEADER_PATH)FramesManager.hpp
OBSERVER_HPP = $(HEADER_PATH)Observer.hpp
ANALYSER_HPP = $(HEADER_PATH)Analyser.hpp
PRINTER_HPP = $(HEADER_PATH)Printer.hpp
CAMERA_HPP = $(HEADER_PATH)Camera.hpp
THREADPOOL_HPP = $(HEADER_PATH)ThreadPool.hpp
WORKER_HPP = $(HEADER_PATH)Worker.hpp
PROCESSOR_HPP = $(HEADER_PATH)Processor.hpp
GREYPROCESSOR_HPP = $(HEADER_PATH)GreyProcessor.hpp
MEANCALCULATOR_HPP = $(HEADER_PATH)MeanCalculator.hpp

MAIN_CPP = $(SRC_PATH)main.cpp
CORE_CPP = $(SRC_PATH)Core.cpp
FRAMESMANAGER_CPP = $(SRC_PATH)FramesManager.cpp
OBSERVER_CPP = $(SRC_PATH)Observer.cpp
ANALYSER_CPP = $(SRC_PATH)Analyser.cpp
PRINTER_CPP = $(SRC_PATH)Printer.cpp
CAMERA_CPP = $(SRC_PATH)Camera.cpp
THREADPOOL_CPP = $(SRC_PATH)ThreadPool.cpp
WORKER_CPP = $(SRC_PATH)Worker.cpp
PROCESSOR_CPP = $(SRC_PATH)Processor.cpp
GREYPROCESSOR_CPP = $(SRC_PATH)GreyProcessor.cpp
MEANCALCULATOR_CPP = $(SRC_PATH)MeanCalculator.cpp

MAIN = $(BIN_DIR)MandrillCore

CORE_O = $(BIN_DIR)Core.o
FRAMESMANAGER_O = $(BIN_DIR)FramesManager.o
OBSERVER_O = $(BIN_DIR)Observer.o
ANALYSER_O = $(BIN_DIR)Analyser.o
PRINTER_O = $(BIN_DIR)Printer.o
CAMERA_O = $(BIN_DIR)Camera.o
THREADPOOL_O = $(BIN_DIR)ThreadPool.o
WORKER_O = $(BIN_DIR)Worker.o
PROCESSOR_O = $(BIN_DIR)Processor.o
GREYPROCESSOR_O = $(BIN_DIR)GreyProcessor.o
MEANCALCULATOR_O = $(BIN_DIR)MeanCalculator.o

CC = clang++

DIRECTIVES = -std=c++0x -Wall -g -c -I $(HEADER_PATH)
OPENCV = `pkg-config --libs opencv` -O4
OBJS = $(CORE_O) $(FRAMESMANAGER_O) $(OBSERVER_O) $(ANALYSER_O) $(PRINTER_O) $(CAMERA_O) $(THREADPOOL_O) $(WORKER_O) $(PROCESSOR_O) $(GREYPROCESSOR_O) $(MEANCALCULATOR_O) $(MAIN_CPP)


$(MAIN): $(BIN_DIR) $(OBJS)
	$(CC) -std=c++0x -I $(HEADER_PATH) $(OBJS) -o $(MAIN) $(OPENCV)

$(CORE_O): $(CORE_CPP) $(FRAMESMANAGER_HPP) $(WORKER_HPP)
	$(CC) $(DIRECTIVES) $(CORE_CPP) -o $(CORE_O) $(OPENCV)

$(FRAMESMANAGER_O): $(FRAMESMANAGER_HPP) $(FRAMESMANAGER_CPP) $(OBSERVER_HPP) $(THREADPOOL_HPP)
	$(CC) $(DIRECTIVES) $(FRAMESMANAGER_CPP) -o $(FRAMESMANAGER_O) $(OPENCV)

$(OBSERVER_O) : $(OBSERVER_HPP) $(OBSERVER_CPP)
	$(CC) $(DIRECTIVES) $(OBSERVER_CPP) -o $(OBSERVER_O) $(OPENCV)

$(ANALYSER_O): $(ANALYSER_HPP) $(ANALYSER_CPP) $(OBSERVER_HPP) $(FRAMESMANAGER_HPP)
	$(CC) $(DIRECTIVES) $(ANALYSER_CPP) -o $(ANALYSER_O) $(OPENCV)

$(CAMERA_O): $(CAMERA_HPP) $(CAMERA_CPP)
	$(CC) $(DIRECTIVES) $(CAMERA_CPP) -o $(CAMERA_O) $(OPENCV)

$(PRINTER_O): $(PRINTER_HPP) $(PRINTER_CPP) $(OBSERVER_HPP) $(FRAMESMANAGER_HPP)
	$(CC) $(DIRECTIVES) $(PRINTER_CPP) -o $(PRINTER_O) $(OPENCV)

$(THREADPOOL_O): $(THREADPOOL_HPP) $(THREADPOOL_CPP) $(WORKER_HPP)
	$(CC) $(DIRECTIVES) $(THREADPOOL_CPP) -o $(THREADPOOL_O) $(OPENCV)

$(WORKER_O): $(WORKER_HPP) $(WORKER_CPP) $(THREADPOOL_HPP)
	$(CC) $(DIRECTIVES) $(WORKER_CPP) -o $(WORKER_O) $(OPENCV)

$(PROCESSOR_O): $(PROCESSOR_HPP) $(PROCESSOR_CPP) $(OBSERVER_HPP) $(FRAMESMANAGER_HPP)
	$(CC) $(DIRECTIVES) $(PROCESSOR_CPP) -o $(PROCESSOR_O) $(OPENCV)

$(GREYPROCESSOR_O): $(GREYPROCESSOR_HPP) $(GREYPROCESSOR_CPP) $(PROCESSOR_HPP)
	$(CC) $(DIRECTIVES) $(GREYPROCESSOR_CPP) -o $(GREYPROCESSOR_O) $(OPENCV)

$(MEANCALCULATOR_O): $(MEANCALCULATOR_HPP) $(MEANCALCULATOR_CPP) $(PROCESSOR_HPP)
	$(CC) $(DIRECTIVES) $(MEANCALCULATOR_CPP) -o $(MEANCALCULATOR_O) $(OPENCV)

$(BIN_DIR):
	mkdir -p $(BIN_DIR)

clean:
	rm -rf $(BIN_DIR)
